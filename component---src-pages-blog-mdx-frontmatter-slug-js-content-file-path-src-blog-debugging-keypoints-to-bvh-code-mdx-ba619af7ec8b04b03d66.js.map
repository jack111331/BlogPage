{"version":3,"file":"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-src-blog-debugging-keypoints-to-bvh-code-mdx-ba619af7ec8b04b03d66.js","mappings":"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","sources":["webpack://blogs/./src/blog/debugging_keypoints_to_bvh_code.mdx","webpack://blogs/./src/pages/blog/{mdx.frontmatter__slug}.js","webpack://blogs/./src/components/Layout/header.js","webpack://blogs/./src/components/Layout/header.module.scss","webpack://blogs/./src/components/Layout/footer.js","webpack://blogs/./src/components/Layout/footer.module.scss","webpack://blogs/./src/components/Layout/markdown.module.scss","webpack://blogs/./src/components/Layout/layout.jsx","webpack://blogs/./src/components/Layout/layout.module.scss","webpack://blogs/./src/components/seo.js","webpack://blogs/./node_modules/@mdx-js/react/lib/index.js","webpack://blogs/./src/components/styles/navbar.module.css","webpack://blogs/./src/components/navbar.js"],"sourcesContent":["/*@jsxRuntime classic @jsx React.createElement @jsxFrag React.Fragment*/\nimport {useMDXComponents as _provideComponents} from \"@mdx-js/react\";\nimport React from \"react\";\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    h1: \"h1\",\n    p: \"p\",\n    a: \"a\",\n    span: \"span\"\n  }, _provideComponents(), props.components);\n  return React.createElement(React.Fragment, null, React.createElement(_components.h1, null, \"Preliminary\"), \"\\n\", React.createElement(_components.p, null, \"Recently, as the text-to-motion generation research becomes popular, approaches to apply them in various domains remain unexplored.\"), \"\\n\", React.createElement(_components.p, null, \"One direct application is to retarget the generated motion to existing agents. In \", React.createElement(_components.a, {\n    href: \"https://github.com/EricGuo5513/momask-codes\"\n  }, \"MoMask's code\"), \", they provide a tool to convert the generated motion's keypoint to BioVision Motion Capture (BVH) format.\\nThis tool allows us to convert the generated motion representation to the format that is widely adopted by industries.\"), \"\\n\", React.createElement(_components.p, null, \"However, there are artifacts appear in the converted motion format, such as twisted foot after turning around, wrongly oriented head, and temporally-inconsistent motion.\\nTo address this issue, it is required to closely inspect the code and fix it to present a visually more pleasing motion visualization result.\"), \"\\n\", React.createElement(_components.h1, null, \"Analysis\"), \"\\n\", React.createElement(_components.p, null, \"MoMask implemented the conversion using the following steps for each frame.\\nFirst, they \", React.createElement(_components.a, {\n    href: \"https://github.com/EricGuo5513/momask-codes/blob/main/visualization/joints2bvh.py#L49\"\n  }, \"extract keypoints\"), \" from the generated motion representation, which is composed of body joints' position, velocity, and rotation information. Note that the reason why they only extract position information is because they don't want the imprecise predicted rotation information to interfere the conversion results.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<div class=\\\"gatsby-highlight\\\" data-language=\\\"python\\\"><pre style=\\\"counter-reset: linenumber NaN\\\" class=\\\"language-python line-numbers\\\"><code class=\\\"language-python\\\">    positions <span class=\\\"token operator\\\">=</span> positions<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span> self<span class=\\\"token punctuation\\\">.</span>re_order<span class=\\\"token punctuation\\\">]</span>\\n    new_anim <span class=\\\"token operator\\\">=</span> self<span class=\\\"token punctuation\\\">.</span>template<span class=\\\"token punctuation\\\">.</span>copy<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n    new_anim<span class=\\\"token punctuation\\\">.</span>rotations <span class=\\\"token operator\\\">=</span> Quaternions<span class=\\\"token punctuation\\\">.</span><span class=\\\"token builtin\\\">id</span><span class=\\\"token punctuation\\\">(</span>positions<span class=\\\"token punctuation\\\">.</span>shape<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span>\\n    new_anim<span class=\\\"token punctuation\\\">.</span>positions <span class=\\\"token operator\\\">=</span> new_anim<span class=\\\"token punctuation\\\">.</span>positions<span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">.</span>repeat<span class=\\\"token punctuation\\\">(</span>positions<span class=\\\"token punctuation\\\">.</span>shape<span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">,</span> axis<span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">)</span>\\n    new_anim<span class=\\\"token punctuation\\\">.</span>positions<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> positions<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">]</span></code><span aria-hidden=\\\"true\\\" class=\\\"line-numbers-rows\\\" style=\\\"white-space: normal; width: auto; left: 0;\\\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"Second, they \", React.createElement(_components.a, {\n    href: \"https://github.com/EricGuo5513/momask-codes/blob/main/visualization/InverseKinematics.py#L66C1-L108C30\"\n  }, \"calculate inverse kinematic\"), \" of the extracted keypoints to match the pre-defined bone structure.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<div class=\\\"gatsby-highlight\\\" data-language=\\\"python\\\"><pre style=\\\"counter-reset: linenumber NaN\\\" class=\\\"language-python line-numbers\\\"><code class=\\\"language-python\\\">    <span class=\\\"token keyword\\\">def</span> <span class=\\\"token function\\\">__call__</span><span class=\\\"token punctuation\\\">(</span>self<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n\\n        children <span class=\\\"token operator\\\">=</span> AnimationStructure<span class=\\\"token punctuation\\\">.</span>children_list<span class=\\\"token punctuation\\\">(</span>self<span class=\\\"token punctuation\\\">.</span>animation<span class=\\\"token punctuation\\\">.</span>parents<span class=\\\"token punctuation\\\">)</span>\\n\\n        <span class=\\\"token keyword\\\">for</span> i <span class=\\\"token keyword\\\">in</span> <span class=\\\"token builtin\\\">range</span><span class=\\\"token punctuation\\\">(</span>self<span class=\\\"token punctuation\\\">.</span>iterations<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n\\n            <span class=\\\"token keyword\\\">for</span> j <span class=\\\"token keyword\\\">in</span> AnimationStructure<span class=\\\"token punctuation\\\">.</span>joints<span class=\\\"token punctuation\\\">(</span>self<span class=\\\"token punctuation\\\">.</span>animation<span class=\\\"token punctuation\\\">.</span>parents<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span>\\n\\n                c <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span>array<span class=\\\"token punctuation\\\">(</span>children<span class=\\\"token punctuation\\\">[</span>j<span class=\\\"token punctuation\\\">]</span><span class=\\\"token punctuation\\\">)</span>\\n                <span class=\\\"token keyword\\\">if</span> <span class=\\\"token builtin\\\">len</span><span class=\\\"token punctuation\\\">(</span>c<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">continue</span>\\n\\n                anim_transforms <span class=\\\"token operator\\\">=</span> Animation<span class=\\\"token punctuation\\\">.</span>transforms_global<span class=\\\"token punctuation\\\">(</span>self<span class=\\\"token punctuation\\\">.</span>animation<span class=\\\"token punctuation\\\">)</span>\\n                anim_positions <span class=\\\"token operator\\\">=</span> anim_transforms<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">:</span><span class=\\\"token number\\\">3</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">3</span><span class=\\\"token punctuation\\\">]</span>\\n                anim_rotations <span class=\\\"token operator\\\">=</span> Quaternions<span class=\\\"token punctuation\\\">.</span>from_transforms<span class=\\\"token punctuation\\\">(</span>anim_transforms<span class=\\\"token punctuation\\\">)</span>\\n\\n                jdirs <span class=\\\"token operator\\\">=</span> anim_positions<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span> c<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">-</span> anim_positions<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span> np<span class=\\\"token punctuation\\\">.</span>newaxis<span class=\\\"token punctuation\\\">,</span> j<span class=\\\"token punctuation\\\">]</span>\\n                ddirs <span class=\\\"token operator\\\">=</span> self<span class=\\\"token punctuation\\\">.</span>positions<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span> c<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">-</span> anim_positions<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span> np<span class=\\\"token punctuation\\\">.</span>newaxis<span class=\\\"token punctuation\\\">,</span> j<span class=\\\"token punctuation\\\">]</span>\\n\\n                jsums <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span>sqrt<span class=\\\"token punctuation\\\">(</span>np<span class=\\\"token punctuation\\\">.</span><span class=\\\"token builtin\\\">sum</span><span class=\\\"token punctuation\\\">(</span>jdirs <span class=\\\"token operator\\\">**</span> <span class=\\\"token number\\\">2.0</span><span class=\\\"token punctuation\\\">,</span> axis<span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">1e-10</span>\\n                dsums <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span>sqrt<span class=\\\"token punctuation\\\">(</span>np<span class=\\\"token punctuation\\\">.</span><span class=\\\"token builtin\\\">sum</span><span class=\\\"token punctuation\\\">(</span>ddirs <span class=\\\"token operator\\\">**</span> <span class=\\\"token number\\\">2.0</span><span class=\\\"token punctuation\\\">,</span> axis<span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">1e-10</span>\\n\\n                jdirs <span class=\\\"token operator\\\">=</span> jdirs <span class=\\\"token operator\\\">/</span> jsums<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span> np<span class=\\\"token punctuation\\\">.</span>newaxis<span class=\\\"token punctuation\\\">]</span>\\n                ddirs <span class=\\\"token operator\\\">=</span> ddirs <span class=\\\"token operator\\\">/</span> dsums<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span> np<span class=\\\"token punctuation\\\">.</span>newaxis<span class=\\\"token punctuation\\\">]</span>\\n\\n                angles <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span>arccos<span class=\\\"token punctuation\\\">(</span>np<span class=\\\"token punctuation\\\">.</span><span class=\\\"token builtin\\\">sum</span><span class=\\\"token punctuation\\\">(</span>jdirs <span class=\\\"token operator\\\">*</span> ddirs<span class=\\\"token punctuation\\\">,</span> axis<span class=\\\"token operator\\\">=</span><span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>clip<span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n                axises <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span>cross<span class=\\\"token punctuation\\\">(</span>jdirs<span class=\\\"token punctuation\\\">,</span> ddirs<span class=\\\"token punctuation\\\">)</span>\\n                axises <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">-</span>anim_rotations<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span> j<span class=\\\"token punctuation\\\">,</span> np<span class=\\\"token punctuation\\\">.</span>newaxis<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">*</span> axises\\n\\n                rotations <span class=\\\"token operator\\\">=</span> Quaternions<span class=\\\"token punctuation\\\">.</span>from_angle_axis<span class=\\\"token punctuation\\\">(</span>angles<span class=\\\"token punctuation\\\">,</span> axises<span class=\\\"token punctuation\\\">)</span>\\n\\n                <span class=\\\"token keyword\\\">if</span> rotations<span class=\\\"token punctuation\\\">.</span>shape<span class=\\\"token punctuation\\\">[</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">==</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">:</span>\\n                    averages <span class=\\\"token operator\\\">=</span> rotations<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">]</span>\\n                <span class=\\\"token keyword\\\">else</span><span class=\\\"token punctuation\\\">:</span>\\n                    averages <span class=\\\"token operator\\\">=</span> Quaternions<span class=\\\"token punctuation\\\">.</span>exp<span class=\\\"token punctuation\\\">(</span>rotations<span class=\\\"token punctuation\\\">.</span>log<span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">.</span>mean<span class=\\\"token punctuation\\\">(</span>axis<span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n\\n                self<span class=\\\"token punctuation\\\">.</span>animation<span class=\\\"token punctuation\\\">.</span>rotations<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span> j<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">=</span> self<span class=\\\"token punctuation\\\">.</span>animation<span class=\\\"token punctuation\\\">.</span>rotations<span class=\\\"token punctuation\\\">[</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">,</span> j<span class=\\\"token punctuation\\\">]</span> <span class=\\\"token operator\\\">*</span> averages\\n\\n            <span class=\\\"token keyword\\\">if</span> <span class=\\\"token keyword\\\">not</span> self<span class=\\\"token punctuation\\\">.</span>silent<span class=\\\"token punctuation\\\">:</span>\\n                anim_positions <span class=\\\"token operator\\\">=</span> Animation<span class=\\\"token punctuation\\\">.</span>positions_global<span class=\\\"token punctuation\\\">(</span>self<span class=\\\"token punctuation\\\">.</span>animation<span class=\\\"token punctuation\\\">)</span>\\n                error <span class=\\\"token operator\\\">=</span> np<span class=\\\"token punctuation\\\">.</span>mean<span class=\\\"token punctuation\\\">(</span>np<span class=\\\"token punctuation\\\">.</span><span class=\\\"token builtin\\\">sum</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">(</span>anim_positions <span class=\\\"token operator\\\">-</span> self<span class=\\\"token punctuation\\\">.</span>positions<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">**</span> <span class=\\\"token number\\\">2.0</span><span class=\\\"token punctuation\\\">,</span> axis<span class=\\\"token operator\\\">=</span><span class=\\\"token operator\\\">-</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">**</span> <span class=\\\"token number\\\">0.5</span><span class=\\\"token punctuation\\\">)</span>\\n                <span class=\\\"token keyword\\\">print</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token string\\\">'[BasicInverseKinematics] Iteration %i Error: %f'</span> <span class=\\\"token operator\\\">%</span> <span class=\\\"token punctuation\\\">(</span>i <span class=\\\"token operator\\\">+</span> <span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> error<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span>\\n\\n        <span class=\\\"token keyword\\\">return</span> self<span class=\\\"token punctuation\\\">.</span>animation</code><span aria-hidden=\\\"true\\\" class=\\\"line-numbers-rows\\\" style=\\\"white-space: normal; width: auto; left: 0;\\\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"However, the keypoints are ill-defined along roll axis.\\nAs a result, the converted BVH format, which contains each joint's rotation, seems egregious.\"), \"\\n\", React.createElement(_components.h1, null, \"Solution\"), \"\\n\", React.createElement(_components.p, null, \"To address this issue, stablizing the roll axis of each joint is necessary.\\nAlthough it seems easy that I just have to zero out all the roll axis, the essence of joint transformation from local joint space to global world space makes things complicated.\\nAs the rotation order matters, the effect of modifying the joint's roll axis in local space is not equal to modifying it in global space.\"), \"\\n\", React.createElement(_components.p, null, \"After searching on the Internet how others handle such a problem, I found a keyword: Swing-Twist decomposition.\\nSwing-twist decomposition is widely adopted in gaming industry for controlling character animation in a more intuitive way.\\nIt works by decomposing a quaternion to a swing and twist components given an axis, so animators can easily interpolate character animation smoothly with either one components.\\nI found it useful for our situation, since our goal of fixing global roll axis can be easily done by stablizing the twist component of each joint.\"), \"\\n\", React.createElement(_components.p, null, \"The pseudo code is provided below and will release after my text-to-motion generation work submitted to SIGGRAPH ASIA published.\"), \"\\n\", React.createElement(_components.span, {\n    dangerouslySetInnerHTML: {\n      __html: \"<div class=\\\"gatsby-highlight\\\" data-language=\\\"text\\\"><pre style=\\\"counter-reset: linenumber NaN\\\" class=\\\"language-text line-numbers\\\"><code class=\\\"language-text\\\">for each joint:\\n    twist_axis = [0, 1, 0] # bone's roll is defined in Y-axis\\n    twist_rotation = local_joint_rotation.twist(twist_axis)\\n    swing_rotation = local_joint_rotation * twist_rotation.inverse()\\n    Get temporally-smoothed frames using exponential moving average over frames\\n    local_joint_rotation = swing_rotation * smoothed_twist_rotation</code><span aria-hidden=\\\"true\\\" class=\\\"line-numbers-rows\\\" style=\\\"white-space: normal; width: auto; left: 0;\\\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\"\n    }\n  }));\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? React.createElement(MDXLayout, props, React.createElement(_createMdxContent, props)) : _createMdxContent(props);\n}\nexport default MDXContent;\n","import GATSBY_COMPILED_MDX from \"/Users/edge/Documents/Code/BlogPage_Production/src/blog/debugging_keypoints_to_bvh_code.mdx\";\nimport * as React from \"react\";\nimport {graphql} from \"gatsby\";\nimport Navbar from \"../../components/navbar\";\nimport Seo from \"../../components/seo\";\nimport Layout from \"../../components/Layout/layout\";\nimport {MDXProvider} from \"@mdx-js/react\";\nconst components = {};\nconst BlogPostTemplate = ({data, children}) => {\n  return React.createElement(\"div\", {\n    style: {\n      backgroundColor: \"#27272a\",\n      color: \"d4d4d8\"\n    }\n  }, React.createElement(Navbar), React.createElement(Layout, {\n    data: data\n  }, React.createElement(MDXProvider, {\n    components: components\n  }, children)));\n};\nexport const query = graphql`\nquery ($id: String) {\n    mdx(id: {eq: $id}) {\n      frontmatter {\n        title\n        date(formatString: \"MMMM D, YYYY\")\n      }\n    }\n}\n`;\nexport const Head = ({data}) => React.createElement(Seo, {\n  title: data.mdx.frontmatter.title\n});\nBlogPostTemplate\nexport default function GatsbyMDXWrapper(props) {\n  return React.createElement(BlogPostTemplate, props, React.createElement(GATSBY_COMPILED_MDX, props));\n}\n","import React from 'react';\nimport { useStaticQuery, graphql, Link } from 'gatsby';\nimport * as styles from './header.module.scss';\n\nconst Header = ({ data }) => {\n  // const {\n  //   site: {\n  //     siteMetadata: { title },\n  //   },\n  // } = useStaticQuery(graphql`\n  //   query {\n  //     site {\n  //       siteMetadata {\n  //         title\n  //       }\n  //     }\n  //   }\n  // `);\n    // Reference {mdx.frontmatter__slug}.js\n    console.log(data);\n  return (\n    <header className={styles.header}>\n      {/* TODO Insert Image */}\n      <h1>\n        <Link className={styles.title}>\n          {data.mdx.frontmatter.title}\n        </Link>\n        <p>Published on {data.mdx.frontmatter.date}</p>\n      </h1>\n    </header>\n  );\n};\n\nexport default Header;","// extracted by mini-css-extract-plugin\nexport var activeNavItem = \"header-module--active-nav-item--33f37\";\nexport var header = \"header-module--header--88d67\";\nexport var navItem = \"header-module--nav-item--783d0\";\nexport var navList = \"header-module--nav-list--8d829\";\nexport var title = \"header-module--title--fd056\";","import React from 'react';\nimport * as styles from './footer.module.scss';\n\nconst Footer = () => {\n  return (\n    <footer className={styles.footer}>\n        © {new Date().getFullYear()} by Edge\n    </footer>\n  );\n};\n\nexport default Footer;","// extracted by mini-css-extract-plugin\nexport var footer = \"footer-module--footer--1e85b\";","// extracted by mini-css-extract-plugin\nexport var abc = \"markdown-module--abc--9ce8a\";\nexport var alert = \"markdown-module--alert--8fd4b\";\nexport var blobNum = \"markdown-module--blob-num--68e1b\";\nexport var code = \"markdown-module--code--35af0\";\nexport var flowChart = \"markdown-module--flow-chart--870cf\";\nexport var geo = \"markdown-module--geo--7972d\";\nexport var gist = \"markdown-module--gist--58f83\";\nexport var graph = \"markdown-module--graph--d741e\";\nexport var graphviz = \"markdown-module--graphviz--5a6cf\";\nexport var gutter = \"markdown-module--gutter--89b4f\";\nexport var lineData = \"markdown-module--line-data--9815e\";\nexport var lineNumbers = \"markdown-module--line-numbers--e513b\";\nexport var linenumber = \"markdown-module--linenumber--45694\";\nexport var markdownBody = \"markdown-module--markdown-body--20d56\";\nexport var mermaid = \"markdown-module--mermaid--41992\";\nexport var night = \"markdown-module--night--06488\";\nexport var noList = \"markdown-module--no-list--4fbac\";\nexport var note_selected = \"markdown-module--note_selected--69afc\";\nexport var pre = \"markdown-module--pre--90cb9\";\nexport var sectionTitle = \"markdown-module--sectionTitle--0140d\";\nexport var sequenceDiagram = \"markdown-module--sequence-diagram--d4256\";\nexport var titleText = \"markdown-module--titleText--01b56\";\nexport var vega = \"markdown-module--vega--4157a\";\nexport var wrap = \"markdown-module--wrap--ed9e3\";\nexport var wrapper = \"markdown-module--wrapper--81a2d\";","import * as React from \"react\"\nimport { useStaticQuery, graphql } from \"gatsby\"\n\n// import \"./layout.css\"\nimport Header from \"./header\"\nimport Footer from \"./footer\"\nimport * as styles from \"./layout.module.scss\"\nimport * as markdownStyles from \"./markdown.module.scss\"\n// import { defineCustomElements as deckDeckGoHighlightElement } from \"@deckdeckgo/highlight-code/dist/loader\";\n// .module is needed in name\n\nconst Layout = ({ data, children }) => {\n  // {\n  //   margin: `0 auto`,\n  //   maxWidth: `var(--size-content)`,\n  //   padding: `var(--size-gutter)`,\n  // }\n  console.log(markdownStyles);\n  // NOTE: If I want to use style nested in some division, just use the tag directly and it will auto select the corresponding tag\n  // TODO: right side shows current progress\n  // TODO: footer should add contact info\n  // TODO: left hand side, can i implement a note taking area and save this on their cookie or what?\n  return (\n    <>\n      <div className={styles.container}>\n        <Header data={data}/>\n        <main className={markdownStyles.markdownBody}>\n          <div className={markdownStyles.pre}>{children}</div>\n        </main>\n        <Footer />\n      </div>\n    </>\n  )\n}\n\nexport default Layout","// extracted by mini-css-extract-plugin\nexport var container = \"layout-module--container--31614\";\nexport var main = \"layout-module--main--068b2\";","import * as React from \"react\"\nimport { useStaticQuery, graphql } from \"gatsby\"\n\nconst Seo = ({ title }) => {\n    const data = useStaticQuery(graphql`\n        query {\n            site {\n                siteMetadata {\n                    title\n                }\n            }\n        }\n    `)\n\n    return <title>{title} | {data.site.siteMetadata.title}</title>\n}\n\nexport default Seo","/**\n * @typedef {import('react').ReactNode} ReactNode\n * @typedef {import('mdx/types.js').MDXComponents} Components\n *\n * @typedef Props\n *   Configuration.\n * @property {Components | MergeComponents | null | undefined} [components]\n *   Mapping of names for JSX components to React components.\n * @property {boolean | null | undefined} [disableParentContext=false]\n *   Turn off outer component context.\n * @property {ReactNode | null | undefined} [children]\n *   Children.\n *\n * @callback MergeComponents\n *   Custom merge function.\n * @param {Components} currentComponents\n *   Current components from the context.\n * @returns {Components}\n *   Merged components.\n */\n\nimport React from 'react'\n\n/**\n * @type {import('react').Context<Components>}\n * @deprecated\n *   This export is marked as a legacy feature.\n *   That means it’s no longer recommended for use as it might be removed\n *   in a future major release.\n *\n *   Please use `useMDXComponents` to get context based components and\n *   `MDXProvider` to set context based components instead.\n */\nexport const MDXContext = React.createContext({})\n\n/**\n * @param {import('react').ComponentType<any>} Component\n * @deprecated\n *   This export is marked as a legacy feature.\n *   That means it’s no longer recommended for use as it might be removed\n *   in a future major release.\n *\n *   Please use `useMDXComponents` to get context based components instead.\n */\nexport function withMDXComponents(Component) {\n  return boundMDXComponent\n\n  /**\n   * @param {Record<string, unknown> & {components?: Components | null | undefined}} props\n   * @returns {JSX.Element}\n   */\n  function boundMDXComponent(props) {\n    const allComponents = useMDXComponents(props.components)\n    return React.createElement(Component, {...props, allComponents})\n  }\n}\n\n/**\n * Get current components from the MDX Context.\n *\n * @param {Components | MergeComponents | null | undefined} [components]\n *   Additional components to use or a function that takes the current\n *   components and filters/merges/changes them.\n * @returns {Components}\n *   Current components.\n */\nexport function useMDXComponents(components) {\n  const contextComponents = React.useContext(MDXContext)\n\n  // Memoize to avoid unnecessary top-level context changes\n  return React.useMemo(() => {\n    // Custom merge via a function prop\n    if (typeof components === 'function') {\n      return components(contextComponents)\n    }\n\n    return {...contextComponents, ...components}\n  }, [contextComponents, components])\n}\n\n/** @type {Components} */\nconst emptyObject = {}\n\n/**\n * Provider for MDX context\n *\n * @param {Props} props\n * @returns {JSX.Element}\n */\nexport function MDXProvider({components, children, disableParentContext}) {\n  /** @type {Components} */\n  let allComponents\n\n  if (disableParentContext) {\n    allComponents =\n      typeof components === 'function'\n        ? components({})\n        : components || emptyObject\n  } else {\n    allComponents = useMDXComponents(components)\n  }\n\n  return React.createElement(\n    MDXContext.Provider,\n    {value: allComponents},\n    children\n  )\n}\n","// extracted by mini-css-extract-plugin\nexport var container = \"navbar-module--container--3089d\";\nexport var navLinkItem = \"navbar-module--nav-link-item--08ec8\";\nexport var navLinks = \"navbar-module--nav-links--79b0c\";\nexport var navbar = \"navbar-module--navbar--fb12b\";\nexport var title = \"navbar-module--title--7ede7\";","import * as React from \"react\"\nimport { Link } from \"gatsby\"\nimport { title, navbar, container, navLinks, navLinkItem } from \"./styles/navbar.module.css\"\n\nconst Navbar = (prop) => {\n    return (\n        <div className={navbar}>\n            <div className={container}>\n                <ul className={navLinks}>\n                    <Link to='/' className={navLinkItem}>Home</Link>\n\n                    {/* <Link to='/portfolio' className={navLinkItem}>Portfolio</Link>\n\n                    <Link to='/publication' className={navLinkItem}>Publication</Link> */}\n                    <Link to='/ongoing_render' className={navLinkItem}>Render testbed</Link>\n\n                    <Link to='/blog' className={navLinkItem}>Blog</Link>\n\n                </ul>\n            </div>\n\n        </div>\n    )\n}\n\n// export default IndexPage\nexport default Navbar"],"names":["_createMdxContent","props","_components","Object","assign","h1","p","a","span","_provideComponents","components","React","href","dangerouslySetInnerHTML","__html","wrapper","MDXLayout","BlogPostTemplate","_ref","data","children","style","backgroundColor","color","Navbar","Layout","MDXProvider","Head","_ref2","Seo","title","mdx","frontmatter","GatsbyMDXWrapper","GATSBY_COMPILED_MDX","console","log","className","Link","date","Footer","Date","getFullYear","abc","blobNum","code","flowChart","geo","gist","graph","graphviz","gutter","lineData","lineNumbers","linenumber","markdownBody","mermaid","night","noList","note_selected","pre","sectionTitle","sequenceDiagram","titleText","vega","wrap","markdownStyles","Header","useStaticQuery","site","siteMetadata","MDXContext","useMDXComponents","contextComponents","_objectSpread","emptyObject","allComponents","disableParentContext","Provider","value","navLinkItem","prop","to"],"sourceRoot":""}